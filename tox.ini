[tox]
envlist=py3
skipdist=True

[common]
deps=
  -r{toxinidir}/requirements.txt
  pytest-cov
  pylint
  pylint-quotes
  pytest-asyncio
  asynctest
  mock

[testenv]
setenv =
    PYTHONPATH = {toxinidir}
    NETBOX_INTEGRATION_HOST = https://netbox.development.cloud.vio.sh
passenv = *
deps={[common]deps}
commands=
    pytest -s \
      --cov-report term-missing \
      --cov aionetbox \
        {posargs}



# List of disabled pylint directives
# - C0111 Module docstrings
# - R1720 Raise after else
# - W0107 Pass statement

[testenv:lint]
description=
    Lint the code for codequality.
deps={[common]deps}
commands=
    pylint --disable=C0111,R1720,W0107 --load-plugins pylint_quotes aionetbox


[testenv:release]
description=
    publish a tagged release to pypi. Used in CI automation.
deps=
    -r{toxinidir}/requirements.txt
    twine>=1.5.0
passenv=*
commands=
    python setup.py sdist bdist_wheel
    twine upload dist/* --verbose
